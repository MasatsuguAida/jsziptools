<!DOCTYPE html>

<html>
    <head>
        <title>read filenames of a zip file</title>
        <script type="text/javascript" src="../lib/DataViewUtils/build/dataview.utils.min.js"></script>
        <script type="text/javascript" src="../src/jsziptools.js"></script>
        <script type="text/javascript" src="../src/utils.js"></script>
        <script type="text/javascript" src="../src/algorithms/adler32.js"></script>
        <script type="text/javascript" src="../src/algorithms/crc32.js"></script>
        <script type="text/javascript" src="../src/algorithms/deflate.js"></script>
        <script type="text/javascript" src="../src/algorithms/inflate.js"></script>
        <script type="text/javascript" src="../src/zlib.compress.js"></script>
        <script type="text/javascript" src="../src/zlib.decompress.js"></script>
        <script type="text/javascript" src="../src/gz.compress.js"></script>
        <script type="text/javascript" src="../src/gz.decompress.js"></script>
        <script type="text/javascript" src="../src/zip.pack.js"></script>
        <script type="text/javascript" src="../src/zip.unpack.js"></script>
        <script type="text/javascript">
            window.onload = function(){
                function cancel(e) {
                    e.preventDefault();
                }

                function on (obj, name, callback) {
                    obj.addEventListener(name, callback, false);
                }

                on(window, 'dragenter', cancel);
                on(window, 'dragover', cancel);
                on(window, 'drop', function(e) {
                    cancel(e);
                    var file = e.dataTransfer.files[0];
                    var fr = new FileReader();
                    
                    fr.onloadend = function() {
                        jz.zip.unpack({
                            buffer: fr.result,
                            complete: function(reader) {
                                var filenames = reader.getFileNames();
                                var filenamesView = document.getElementById('filenames-view');

                                filenamesView.innerHTML = filenames.map(function(filename){ return '<li>' + filename; }).join('\n');
                                
                            }
                        });
                    };

                    fr.readAsArrayBuffer(file);
                });
            };
        </script>
    </head>
    <body>
        <h1>Read filenames of a zip file.</h1>
        <p>drag &amp; drop a zip file this window.</p>
        <ul id="filenames-view"></ul>
    </body>
</html>